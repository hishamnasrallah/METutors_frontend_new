<ng-container *ngLet="(interview$ | async) as interview">
  <div class="interview-details">
    <div class="card">
      <div class="card-body">
        <ng-container *ngIf="!(isLoading$ | async)">
          <div class="row">
            <div class="col-md-6">
              <h1>Tutor Data Sheet</h1>
              <div class="row list-items md-item p-0 mt-3">
                <div class="col-md-5 d-flex menu align-items-center" *ngIf="interview?.tutor?.country">
                  <img src="assets/svg/map.svg" alt="" width="15" height="15" draggable="false">
                  <strong>From {{ interview?.tutor?.country }}</strong>
                </div>
                <div class="col-md-5 d-flex menu align-items-center"
                  *ngIf="interview?.tutor?.specifications?.levelOfEducation && interview?.tutor?.specifications?.subject">
                  <img src="assets/svg/time.svg" alt="" width="15" height="15" draggable="false">
                  <strong>
                    {{ interview?.tutor?.specifications?.levelOfEducation }}
                    of {{ interview?.tutor?.specifications?.subject }}
                  </strong>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="d-flex justify-content-end actions-interview">
                <a class="submit-document" [routerLink]="['/admin', 'tutor', 'interview', 'details', '1', 'documents']">
                  Submitted Documents
                </a>
                <a class="send-link cursor-pointer" *ngIf="interview.status === 'pending'" (click)="onOpenScheduleInterviewModal(interview)">Schedule Interview</a>
                <ng-container>
                  <ng-container [ngSwitch]="isJoiningInterview$ | async">
                    <span *ngSwitchCase="true" class="joining-interview">Join Interview</span>
                    <a class="send-link cursor-pointer" *ngSwitchCase="false" (click)="joinInterview()">Join Interview</a>
                  </ng-container>
                </ng-container>

              </div>
              <div class="row list-items md-item p-0 d-flex justify-content-end mt-3">
                <div class="col-md-3 d-flex menu align-items-center" *ngIf="interview?.interviewDate">
                  <img src="assets/svg/calendar.svg" alt="" width="15" height="15" draggable="false">
                  <strong>{{ interview?.interviewDate }}</strong>
                </div>
                <div class="col-md-3 d-flex menu align-items-center" *ngIf="interview?.interviewTime">
                  <img src="assets/svg/time.svg" alt="" width="15" height="15" draggable="false">
                  <strong>{{ interview?.interviewTime }}</strong>
                </div>
              </div>
            </div>
          </div>

          <div class="row mt-5">
            <div class="col-md-5">
              <h3 class="title d-flex align-items-center">
                <img [src]="interview?.tutor?.avatar" meTutorsDefaultAvatar alt="" class="rounded-circle me-3"
                  width="50px" height="50px">
                Personal Information
              </h3>
              <table class="basic-table">
                <tr>
                  <td>Full Name</td>
                  <td><bdi>{{ interview?.tutor?.name }}</bdi></td>
                </tr>
                <tr *ngIf="interview?.tutor?.email">
                  <td>Email</td>
                  <td>{{ interview?.tutor?.email }}</td>
                </tr>
                <tr *ngIf="interview?.tutor?.mobile">
                  <td>Phone</td>
                  <td>{{ interview?.tutor?.mobile }}</td>
                </tr>
                <tr *ngIf="interview?.tutor?.gender">
                  <td>Gender</td>
                  <td class="text-capitalize">{{ interview?.tutor?.gender }}</td>
                </tr>
                <tr *ngIf="interview?.tutor?.country">
                  <td>Location</td>
                  <td>
                    {{ interview?.tutor?.country }}
                    <ng-container *ngIf="interview?.tutor?.city">, {{ interview?.tutor?.city }}</ng-container>
                  </td>
                </tr>
                <tr *ngIf="interview?.tutor?.nationality">
                  <td>Nationality</td>
                  <td>{{ interview?.tutor?.nationality }}</td>
                </tr>
                <tr *ngIf="interview?.tutor?.dateOfBirth">
                  <td>Date of birth</td>
                  <td>{{ interview?.tutor?.dateOfBirth }}</td>
                </tr>
              </table>
            </div>
            <div class="col-md-7" *ngIf="interview?.tutor?.qualifications?.video">
              <metutors-video-player [videoSrc]="interview?.tutor?.qualifications?.video">
              </metutors-video-player>
            </div>
          </div>

          <div class="row mt-5">
            <h3 class="title">Qualification Details</h3>
            <div class="col-md-6">
              <table class="basic-table w-100">
                <tr *ngIf="interview?.tutor?.qualifications?.nameOfUniversity">
                  <td>University</td>
                  <td>{{ interview?.tutor?.qualifications?.nameOfUniversity }}</td>
                </tr>
                <tr *ngIf="interview?.tutor?.qualifications?.degreeLevel">
                  <td>Degree Level</td>
                  <td>{{ interview?.tutor?.qualifications?.degreeLevel }}</td>
                </tr>
                <tr *ngIf="interview?.tutor?.qualifications?.degreeField">
                  <td>Degree Field/Major</td>
                  <td>{{ interview?.tutor?.qualifications?.degreeField }}</td>
                </tr>
                <tr *ngIf="interview?.tutor?.languages && interview?.tutor?.languages?.length">
                  <td>Spoken Languages</td>
                  <td>
                    <ng-container *ngFor="let lang of interview?.tutor?.languages; let isLast = last">
                      {{ lang?.name?.name }}<ng-container *ngIf="!isLast">, </ng-container>
                    </ng-container>
                  </td>
                </tr>
                <tr *ngIf="interview?.tutor?.qualifications?.currentEmployer">
                  <td>Current Employer</td>
                  <td>{{ interview?.tutor?.qualifications?.currentEmployer }}</td>
                </tr>
              </table>
            </div>
            <div class="col-md-6">
              <table class="basic-table w-100">
                <tr *ngIf="interview?.tutor?.qualifications?.computerSkills">
                  <td>Computer Skills Level</td>
                  <td>{{ interview?.tutor?.qualifications?.computerSkills }}</td>
                </tr>
                <tr *ngIf="interview?.tutor?.specifications?.typeOfTutoring">
                  <td>Type</td>
                  <td>{{ interview?.tutor?.specifications?.typeOfTutoring }}</td>
                </tr>
                <tr *ngIf="interview?.tutor?.qualifications?.teachingExperience">
                  <td>Teaching Experience<span>(In Schools)</span></td>
                  <td>{{ interview?.tutor?.qualifications?.teachingExperience }}</td>
                </tr>
                <tr *ngIf="interview?.tutor?.qualifications?.teachingExperienceOnline">
                  <td>Teaching Experience<span>(Online)</span></td>
                  <td>{{ interview?.tutor?.qualifications?.teachingExperienceOnline }}</td>
                </tr>
                <tr *ngIf="interview?.tutor?.qualifications?.currentTitle">
                  <td>Current Title</td>
                  <td>{{ interview?.tutor?.qualifications?.currentTitle }}</td>
                </tr>
              </table>
            </div>
          </div>

          <div class="row mt-5">
            <h3 class="title">Teaching Specifications</h3>
            <div class="col-md-6">
              <table class="basic-table w-100">
                <tr *ngIf="interview?.tutor?.specifications?.levelOfEducation">
                  <td>Level of Education</td>
                  <td>{{ interview?.tutor?.specifications?.levelOfEducation }}</td>
                </tr>
                <tr *ngIf="interview?.tutor?.specifications?.typeOfTutoring">
                  <td>Type of Tutoring</td>
                  <td>{{ interview?.tutor?.specifications?.typeOfTutoring }}</td>
                </tr>
                <tr *ngIf="interview?.tutor?.specifications?.teachingDays">
                  <td>Days</td>
                  <td>{{ interview?.tutor?.specifications?.teachingDays }}</td>
                </tr>
              </table>
            </div>
            <div class="col-md-6">
              <table class="basic-table w-100">
                <tr *ngIf="interview?.tutor?.specifications?.availabilityStartDate">
                  <td>Expected Starting Date</td>
                  <td>{{ interview?.tutor?.specifications?.availabilityStartDate }}</td>
                </tr>
                <tr *ngIf="interview?.tutor?.specifications?.availabilityEndDate">
                  <td>Availability Ending Date</td>
                  <td>{{ interview?.tutor?.specifications?.availabilityEndDate }}</td>
                </tr>
              </table>
            </div>
          </div>

          <div class="row mt-5" *ngIf="interview?.tutor?.sortedSubjects && interview?.tutor?.sortedSubjects.length">
            <div class="col-md-6 mb-3" *ngFor="let item of interview?.tutor?.sortedSubjects; let indexSubjects = index">
              <table class="table my-table default-title">
                <tr>
                  <th class="heading" [attr.colspan]="item?.programId === nationalId ? '2' : '1'">
                    Program <span>
                      {{ item?.programName }}<ng-container *ngIf="item?.programId === nationalId">,
                        {{ item?.countryName }}
                      </ng-container>
                    </span>
                  </th>
                  <th class="heading">Field Name <span>{{ item?.fieldName }}</span></th>
                </tr>
                <tr>
                  <th>Field</th>
                  <th *ngIf="item?.programId === nationalId">Grade</th>
                  <th>Hourly Price</th>
                </tr>
                <tr *ngFor="let subject of item.subjects">
                  <td>{{ subject?.subject }}</td>
                  <td *ngIf="item?.programId === nationalId">{{ subject?.gradeName }}</td>
                  <td>
                    {{ subject?.pricePerHour }}
                  </td>
                </tr>
              </table>
            </div>
          </div>

          <div class="row mt-4">
            <div class="col-md-12 notes">
              <ng-container *ngIf="interview?.additionalComments">
                <h2>Notes:</h2>
                <p>
                  <bdi>{{ interview?.additionalComments }}</bdi>
                </p>
              </ng-container>
 
              <div class="actions d-flex justify-content-end" *ngIf="interview?.status === interviewStatus.pending">
                <button mat-button class="fw-bold me-3 decline"  (click)="onOpenDeclineInterviewModal()">Decline</button>
                <button mat-flat-button color="primary" class="fw-bold" (click)="onOpenHourlyRatePerSubjectModal()">
                  Accept Request
                </button>
              </div>
            </div>
          </div>
        </ng-container>

        <ng-container *ngIf="isLoading$ | async">
          <metutors-grid-placeholder></metutors-grid-placeholder>
          <metutors-grid-placeholder></metutors-grid-placeholder>
        </ng-container>
      </div>
    </div>
  </div>

  <metutors-admin-schedule-interview-modal *ngIf="showScheduleInterviewModal$ | async" [data]="data"
                                           [isSchedulingRequest]="(isSchedulingRequest$ | async)!"
                                           (closeModal)="onCloseScheduleInterviewModal()"
                                           (submitted)="scheduleInterviewRequest($event)"
                                           [showModal]="(showScheduleInterviewModal$ | async)!">
  </metutors-admin-schedule-interview-modal>

  <metutors-admin-hourly-rate-per-subject-modal *ngIf="showHourlyRatePerSubjectModal$ | async"
                                                [subjects]="interview?.tutor?.subjects"
                                                [sortedSubjects]="interview.tutor?.sortedSubjects"
                                                [isAcceptingRequest]="(isAcceptingRequest$ | async)!"
                                                (closeModal)="onCloseHourlyRatePerSubjectModal()"
                                                (submitted)="acceptInterviewRequest($event, interview.id)"
                                                [showModal]="(showHourlyRatePerSubjectModal$ | async)!">
  </metutors-admin-hourly-rate-per-subject-modal>

  <metutors-admin-decline-interview-modal *ngIf="showDeclineRequestModal$ | async"
                                          [isDeclineRequest]="(isDeclineRequest$ | async)!"
                                          (closeModal)="onCloseDeclineRequestModal()"
                                          (submitted)="declineInterviewRequest($event, interview.id)"
                                          [showModal]="(showDeclineRequestModal$ | async)!">
  </metutors-admin-decline-interview-modal>
</ng-container>
