<form [formGroup]="form" (ngSubmit)="submitFormData()" class="w-100">
  <div>
    <h4 class="mb-5 heading text-center">PROVIDE YOUR TEACHING SPECIFICATIONS</h4>

    <div class="row">
      <div class="col-md-6">
        <div class="form-group">
          <label for="levelOfEducation" class="form-label">Education Level</label>
          <mat-form-field appearance="outline" class="w-100">
            <mat-select formControlName="levelOfEducation" [placeholder]="'Select Level'">
              <mat-option [value]="level.id" *ngFor="let level of levels">
                {{ level.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <div class="text-danger" *ngIf="levelOfEducation?.touched && levelOfEducation?.invalid">
            Please choose your Level
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="form-group">
          <label for="salaryPerHour" class="form-label">Hourly Expected Salary (USD)</label>
          <input type="text" class="custom-input w-100 input-bordered" id="salaryPerHour" placeholder="0"
            formControlName="salaryPerHour" crossRoadsOnlyNumber>
          <div class="text-danger" *ngIf="salaryPerHour?.touched && salaryPerHour?.invalid">
            Please write your Expected Salary (minimum is 5 & maximum is 999)
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6">
        <div class="form-group">
          <label for="program" class="form-label">Select the program</label>
          <mat-form-field appearance="outline" class="w-100">
            <mat-select formControlName="program" [placeholder]="'Select Program'" multiple>
              <mat-option [value]="program?.id" *ngFor="let program of programs">{{ program?.name }}</mat-option>
            </mat-select>
          </mat-form-field>
          <div class="text-danger" *ngIf="program?.touched && program?.invalid">
            Please write your Program
          </div>

          <mat-form-field appearance="outline" class="w-100" *ngIf="form.value.program?.includes(nationalId)">
            <mat-select formControlName="country" [placeholder]="'Select country for national'" multiple>
              <mat-option [value]="country?.id" *ngFor="let country of countries">{{ country?.name }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>

      <div class="col-md-6">
        <div class="form-group">
          <label for="startDate" class="form-label">When you are Available to Start?</label>
          <mat-form-field appearance="outline" class="w-100">
            <input matInput [matDatepicker]="datetPicker2" [placeholder]="'04/02/2022'" (focus)="datetPicker2.open()"
              [min]="minDate" formControlName="startDate">
            <mat-datepicker-toggle matSuffix [for]="datetPicker2"></mat-datepicker-toggle>
            <mat-datepicker #datetPicker2></mat-datepicker>
          </mat-form-field>
          <div class="text-danger" *ngIf="startDate?.touched && startDate?.invalid">
            Please select your Availability to Start
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6">
        <div class="form-group">
          <div>
            <label for="subjects" class="form-label">Field of study</label>
            <a class="float-end cursor-pointer" (click)="addSubject()">Add new</a>
          </div>

          <ng-container formArrayName="subjects">
            <ng-container *ngFor="let _ of subjects.controls; let i = index" [formGroupName]="i">
              <ng-container *ngIf="!form.value.subjects[i].field || !form.value.subjects[i].subject">
                <mat-form-field appearance="outline" class="w-100 mt-3">
                  <mat-select formControlName="field" [placeholder]="'Select Field'" (selectionChange)="onChangeField($event)">
                    <ng-container *ngFor="let field of fields">
                      <mat-option [value]="field" *ngIf="form.value.program?.includes(field?.programId)">
                        {{ field?.name }}</mat-option>
                    </ng-container>
                  </mat-select>
                </mat-form-field>

                <mat-form-field appearance="outline" class="w-100">
                  <mat-select formControlName="subject" [placeholder]="'Select subject'">
                    <mat-option [value]="subject" *ngFor="let subject of subjectsList">
                      {{ subject?.name }}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </ng-container>
            </ng-container>
          </ng-container>

          <mat-chip-list>
            <ng-container *ngFor="let subj of form.value.subjects; let i = index">
              <mat-chip *ngIf="subj.field && subj.subject">
                <div class="subj-info d-flex align-items-center justify-content-center">
                  {{ subj.field?.name }} - <span>{{ subj.subject?.name }}</span>
                  <mat-icon (click)="removeSubject(i)">cancel</mat-icon>
                </div>
              </mat-chip>
            </ng-container>
          </mat-chip-list>
          <!-- <label for="subject" class="form-label">Select Subject</label>
          <mat-form-field appearance="outline" class="w-100">
            <mat-select formControlName="subject" [placeholder]="'Math'">
              <mat-option value="Math">Math</mat-option>
              <mat-option value="Physics">Physics</mat-option>
              <mat-option value="Chemistry">Chemistry</mat-option>
            </mat-select>
          </mat-form-field>
          <div class="text-danger" *ngIf="subject?.touched && subject?.invalid">
            Please choose your Subject
          </div> -->
        </div>
      </div>

      <div class="col-md-6">
        <div class="form-group">
          <label for="endDate" class="form-label">Availability End Date</label>
          <mat-form-field appearance="outline" class="w-100">
            <input matInput [matDatepicker]="datetPicker3" [placeholder]="'04/02/2022'" (focus)="datetPicker3.open()"
              [min]="startDate?.value" formControlName="endDate">
            <mat-datepicker-toggle matSuffix [for]="datetPicker3"></mat-datepicker-toggle>
            <mat-datepicker #datetPicker3></mat-datepicker>
          </mat-form-field>
          <div class="text-danger" *ngIf="endDate?.touched && endDate?.invalid">
            Please select your Availability End Date
          </div>
        </div>
      </div>
    </div>

    <div class="row mt-3">
      <div class="col-md-6">
        <div class="form-group">
          <label class="form-label">Type of Tutoring</label>
          <mat-radio-group class="d-flex flex-column mt-3" formControlName="typeOfTutoring">
            <mat-radio-button class="mb-2" [value]="type.value" *ngFor="let type of types | keyvalue: returnZero">
              {{ type?.value }}
            </mat-radio-button>
          </mat-radio-group>
          <div class="text-danger" *ngIf="typeOfTutoring?.touched && typeOfTutoring?.invalid">
            Please select Type of Tutoring
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="form-group">
          <label class="form-label">How many days per week are you available? </label>
          <div class="list-days">
            <button type="button" mat-button [class.active]="selectedDays?.includes(i)"
              *ngFor="let day of days; let i = index" (click)="onChangeDay(i)">{{ day }}</button>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-4"></div>
      <div class="col-md-4">
        <div class="form-group mt-4 mb-2">
          <metutors-submit-button [form]="form" [isSubmitting]="loading" [extraClasses]="'w-100'">
            Finish
          </metutors-submit-button>
        </div>
      </div>
      <div class="col-md-4"></div>
    </div>
  </div>
</form>
