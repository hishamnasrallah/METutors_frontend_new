<form [formGroup]="form" (ngSubmit)="submitFormData()" class="w-100 p-10-sm">
  <div>
    <h4 class="mb-5 heading text-center f-size-18-md-sm mb-15-sm">PROVIDE YOUR QUALIFICATION DETAILS</h4>

    <div class="row">
      <div class="col-md-6">
        <div class="form-group">
          <label for="nameOfUniversity" class="form-label">Name of University</label>
          <input type="text" class="custom-input w-100 input-bordered" id="nameOfUniversity" placeholder="Enter Name"
            formControlName="nameOfUniversity">
          <div class="text-danger" *ngIf="nameOfUniversity?.touched && nameOfUniversity?.invalid">
            Please write your University name
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="form-group">
          <label for="teachingExperience" class="form-label">Teaching Experience</label>
          <mat-form-field appearance="outline" class="w-100">
            <mat-select formControlName="teachingExperience" [placeholder]="'Select Years'" id="teachingExperience">
              <mat-option [value]="experience" *ngFor="let experience of experiences">{{ experience }}</mat-option>
            </mat-select>
          </mat-form-field>
          <div class="text-danger" *ngIf="teachingExperience?.touched && teachingExperience?.invalid">
            Please choose your years of teaching experience in schools
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6">
        <div class="form-group">
          <label for="degreeLevel" class="form-label">Degree Level</label>
          <mat-form-field appearance="outline" class="w-100">
            <mat-select formControlName="degreeLevel" [placeholder]="'Select Degree Level'" id="degreeLevel"
              (selectionChange)="resetDegreeField()">
              <mat-option [value]="level" *ngFor="let level of degreeLevels">{{ level }}</mat-option>
            </mat-select>
          </mat-form-field>
          <div class="text-danger" *ngIf="degreeLevel?.touched && degreeLevel?.invalid">
            Please choose your degree level
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="form-group">
          <label for="teachingExperienceOnline" class="form-label">Teaching Experience Online</label>
          <mat-form-field appearance="outline" class="w-100">
            <mat-select formControlName="teachingExperienceOnline" [placeholder]="'Select Years'" id="teachingExperienceOnline">
              <mat-option [value]="experience" *ngFor="let experience of experiences">{{ experience }}</mat-option>
            </mat-select>
          </mat-form-field>
          <div class="text-danger" *ngIf="teachingExperienceOnline?.touched && teachingExperienceOnline?.invalid">
            Please choose your years of teaching experience online
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6">
        <div class="form-group">
          <label for="degreeField" class="form-label">Degree Field</label>
          <mat-form-field appearance="outline" class="w-100">
            <mat-select formControlName="degreeField" [placeholder]="'Computer Science'" id="degreeField">
              <mat-option>
                <ngx-mat-select-search [(ngModel)]="filterDegree" [ngModelOptions]="{standalone: true}"
                  placeholderLabel="Search..." noEntriesFoundLabel="No matching degree field found">
                </ngx-mat-select-search>
              </mat-option>
              <mat-option [value]="field" *ngFor="let field of filteredDegreeFields">{{ field }}</mat-option>
            </mat-select>
          </mat-form-field>
          <div class="text-danger" *ngIf="degreeField?.touched && degreeField?.invalid">
            Please choose your degree field
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="form-group">
          <label for="currentEmployer" class="form-label">Current Employer <span>(Optional)</span></label>
          <input type="text" class="custom-input w-100 input-bordered" id="currentEmployer" placeholder="Enter Here"
                 formControlName="currentEmployer">
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6">
        <div class="form-group">
          <label for="computerSkills" class="form-label">Computer Skills</label>
          <mat-form-field appearance="outline" class="w-100">
            <mat-select formControlName="computerSkills" [placeholder]="'Above Average'" id="computerSkills">
              <mat-option [value]="skill" *ngFor="let skill of skills">{{ skill }}</mat-option>
            </mat-select>
          </mat-form-field>
          <div class="text-danger" *ngIf="computerSkills?.touched && computerSkills?.invalid">
            Please choose your computer skill level
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="form-group">
          <label for="currentTitle" class="form-label">Current Title <span>(Optional)</span></label>
          <input type="text" class="custom-input w-100 input-bordered" id="currentTitle" placeholder="Enter Here"
                 formControlName="currentTitle">
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6">
        <div class="form-group">
          <div>
            <label for="languages" class="form-label">Spoken languages <span>(For Teaching)</span></label>
            <a class="float-end cursor-pointer" (click)="addLanguage()"
              [ngClass]="{'text-secondary cursor-not-allowed': languages.status === invalid}">Add New</a>
          </div>
          <metutors-spoken-languages [form]="form" [languagesList]="languagesList" id="languages"
                                     (removeLanguage)="removeLanguage($event)">
          </metutors-spoken-languages>
        </div>
      </div>

      <div class="col-md-6">
        <div class="form-group">
          <label class="form-label">Your Demo of Teaching Online <span>(3 - 5 Minutes)</span></label>
          <input type="file" #filePicker (change)="onChangeVideo($event)" hidden accept="video/*" />

          <div class="position-relative">
            <metutors-video-player [videoSrc]="video?.value" *ngIf="video?.value">
            </metutors-video-player>
            <button mat-flat-button color="primary" class="px-4 edit-video" type="button"
              *ngIf="video?.value" (click)="filePicker.click()" [disabled]="uploadingVideo"> Change
            </button>
          </div>
          <div class="video-preview d-flex align-items-center justify-content-center flex-column" *ngIf="!video?.value">
            <div class="guide1">Upload Video Demo</div>

            <button mat-flat-button color="primary" class="px-4 mt-2" type="button" [disabled]="uploadingVideo"
              (click)="filePicker.click()"> Upload
            </button>
          </div>
          <ng-container *ngLet="fileUploadProgress$ | async as fileUploadProgress">
            <ng-container *ngIf="fileUploadProgress?.length">
              <ng-container *ngFor="let uploadProgress of fileUploadProgress">
                <ng-container *ngIf="uploadProgress.responseType !== uploadComplete">
                  <metutors-file-upload-progress [fileName]="uploadProgress.fileName"
                                                 [uploadedPercentage]="uploadProgress.progress">
                  </metutors-file-upload-progress>
                </ng-container>
              </ng-container>
            </ng-container>
          </ng-container>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-4"></div>
      <div class="col-md-4">
        <div class="form-group mt-4 mb-2">
          <metutors-submit-button [form]="form" [isSubmitting]="loading" [isDisabled]="uploadingVideo" [extraClasses]="'w-100 fw-bold'">
            Save & Continue
          </metutors-submit-button>
        </div>
      </div>
      <div class="col-md-4"></div>
    </div>
  </div>
</form>
